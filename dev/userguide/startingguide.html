
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting Started with MetPy &#8212; MetPy 1.0dev</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap');
</style>
    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme-unidata.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/doc_shared.js"></script>
    <link rel="shortcut icon" href="../_static/metpy_32x32.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Install Guide" href="installguide.html" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    <link rel="canonical" href="https://unidata.github.io/MetPy/latest/userguide/startingguide.html" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
  <nav class="navbar navbar-dark navbar-expand-lg bg-unidata fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/metpy_horizontal.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>


    <div id="navbar-menu" class="collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">


        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Version 1.0dev
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown" id="version-menu"></div>
        </li>


        
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">User Guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../api/index.html">Reference Guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../devel/index.html">Developer’s Guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../examples/index.html">Example Gallery</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="SUPPORT.html">Support</a>
        </li>
        
        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://github.com/Unidata/MetPy/releases">Release Notes<i class="fas fa-external-link-alt"></i></a>
        </li>
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Unidata/MetPy" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/MetPy" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
  </nav>


    <div class="container-fluid" id="banner"></div>


    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
          
            
                <li class="">
                    <a href="installguide.html">Install Guide</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Getting Started with MetPy</a>
                </li>
            
          
            
                <li class="">
                    <a href="../tutorials/index.html">Tutorials</a>
                </li>
            
          
            
                <li class="">
                    <a href="upgradeguide.html">MetPy 1.0 Upgrade Guide</a>
                </li>
            
          
            
                <li class="">
                    <a href="gempak.html">GEMPAK Comparison Guide</a>
                </li>
            
          
            
                <li class="">
                    <a href="SUPPORT.html">Support</a>
                </li>
            
          
            
                <li class="">
                    <a href="citing.html">Citing MetPy</a>
                </li>
            
          
            
                <li class="">
                    <a href="media.html">Talks and Other Media</a>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#units" class="nav-link">Units</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#functionality" class="nav-link">Functionality</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#input-output" class="nav-link">Input/Output</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#calculations" class="nav-link">Calculations</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#plotting" class="nav-link">Plotting</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#skew-t" class="nav-link">Skew-T</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#station-plots" class="nav-link">Station Plots</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#gridded-data" class="nav-link">Gridded Data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#declarative-plotting" class="nav-link">Declarative Plotting</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#other-python-resources" class="nav-link">Other Python Resources</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#support" class="nav-link">Support</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="getting-started-with-metpy">
<h1>Getting Started with MetPy<a class="headerlink" href="#getting-started-with-metpy" title="Permalink to this headline">¶</a></h1>
<p>Welcome to MetPy! We’re glad you’re here and we hope that you find this Python library
to be useful for your needs. In order to help get you started with MetPy, we’ve put together
this guide to introduce you to the basic syntax and functionality of this library. If you’re
new to Python, please visit the <a class="reference external" href="https://unidata.github.io/python-training">Unidata Python Training</a> site for in-depth
discussion and examples of the Scientific Python ecosystem.</p>
<p>For installation instructions, please see our <a class="reference internal" href="installguide.html"><span class="doc">Install Guide</span></a>.</p>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>For the in-depth explanation of units, associated syntax, and unique features, please see
our <a class="reference internal" href="../tutorials/unit_tutorial.html"><span class="doc">Units Tutorial</span></a> page. What follows in this section is
a short summary of how MetPy uses units.</p>
<p>One of the most significant differences in syntax for MetPy, compared to other Python
libraries, is the frequent requirement of units to be attached to arrays before being
passed to MetPy functions. There are very few exceptions to this, and you’ll usually be
safer to always use units whenever applicable to make sure that your analyses are done
correctly. Once you get used to the units syntax, it becomes very handy, as you never have
to worry about unit conversion for any calculation. MetPy does it for you!</p>
<p>To demonstrate the units syntax briefly here, we can do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>

<span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">meters</span>
</pre></div>
</div>
<p>Another way to attach units is do create the array directly with the <a class="reference external" href="https://pint.readthedocs.io/en/stable/developers_reference.html#pint.Quantity" title="(in pint v0.16.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pint.Quantity</span></code></a>
object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;sec&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Unit-aware calculations can then be done with these variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span><span class="p">]</span> <span class="n">meter</span> <span class="o">/</span> <span class="n">second</span>
</pre></div>
</div>
<p>In addition to the <a class="reference internal" href="../tutorials/unit_tutorial.html"><span class="doc">Units Tutorial</span></a> page, checkout the MetPy
Monday blog on
<a class="reference external" href="https://www.unidata.ucar.edu/blogs/developer/en/entry/metpy-mondays-4-units-in">units</a> or
watch our MetPy Monday video on
<a class="reference external" href="https://www.youtube.com/watch?v=iveJCqxe3Z4">temperature units</a>.</p>
</div>
<div class="section" id="functionality">
<h2>Functionality<a class="headerlink" href="#functionality" title="Permalink to this headline">¶</a></h2>
<p>MetPy aims to have three primary purposes: read and write meteorological data (I/O), calculate
meteorological quantities with well-documented equations, and create publication-quality plots
of meteorological data. The three subsections that follow will demonstrate just some of this
functionality. For full reference to all of MetPy’s API, please see our
<a class="reference internal" href="../api/index.html"><span class="doc">Reference Guide</span></a>.</p>
<div class="section" id="input-output">
<h3>Input/Output<a class="headerlink" href="#input-output" title="Permalink to this headline">¶</a></h3>
<p>MetPy has built in support for reading GINI satellite and NEXRAD radar files. If you have one
of these files, opening it with MetPy is as easy as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metpy.io</span> <span class="kn">import</span> <span class="n">Level2File</span><span class="p">,</span> <span class="n">Level3File</span><span class="p">,</span> <span class="n">GiniFile</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">GiniFile</span><span class="p">(</span><span class="n">example_filename</span><span class="o">.</span><span class="n">gini</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Level2File</span><span class="p">(</span><span class="n">example_filename</span><span class="o">.</span><span class="n">gz</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Level3File</span><span class="p">(</span><span class="n">example_filename</span><span class="o">.</span><span class="n">gz</span><span class="p">)</span>
</pre></div>
</div>
<p>From there, you can pull out the variables you want to analyze and plot. For more information,
see the <a class="reference internal" href="../examples/formats/GINI_Water_Vapor.html"><span class="doc">GINI</span></a>,
<a class="reference internal" href="../examples/formats/NEXRAD_Level_2_File.html"><span class="doc">NEXRAD Level 2</span></a>, and
<a class="reference internal" href="../examples/formats/NEXRAD_Level_3_File.html"><span class="doc">NEXRAD Level 3</span></a> examples. MetPy Monday videos
<a class="reference external" href="https://youtu.be/73fhfV2zOt8">#29</a> and <a class="reference external" href="https://youtu.be/fSax8g9EfxM">#30</a> also show how to plot radar files with MetPy.</p>
<p>The other exciting feature is MetPy’s Xarray accessor. Xarray is a Python package that
makes working with multi-dimensional labeled data (i.e. netCDF files) easy. For a thorough
look at Xarray’s capabilities, see this <a class="reference external" href="https://youtu.be/_9j7Y1-lk-o">MetPy Monday video</a>.
With MetPy’s accessor to this package, we can quickly pull out common dimensions, parse
Climate and Forecasting (CF) metadata, and handle projection information. While the
<a class="reference internal" href="../tutorials/xarray_tutorial.html"><span class="doc">Xarray with MetPy</span></a> is the best place to see the full
utility of the MetPy Xarray accessor, let’s demonstrate some of the functionality here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">metpy</span>
<span class="kn">from</span> <span class="nn">metpy.cbook</span> <span class="kn">import</span> <span class="n">get_test_data</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">get_test_data</span><span class="p">(</span><span class="s1">&#39;narr_example.nc&#39;</span><span class="p">,</span> <span class="n">as_file_obj</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">parse_cf</span><span class="p">()</span>

<span class="c1"># Grab lat/lon values from file as unit arrays</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">unit_array</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">unit_array</span>

<span class="c1"># Get the valid time</span>
<span class="n">vtime</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">Temperature_isobaric</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Get the 700-hPa heights without manually identifying the vertical coordinate</span>
<span class="n">hght_700</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">Geopotential_height_isobaric</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">vertical</span><span class="o">=</span><span class="mi">700</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span><span class="p">,</span>
                                                 <span class="n">time</span><span class="o">=</span><span class="n">vtime</span><span class="p">)</span>
</pre></div>
</div>
<p>From here, you could make a map of the 700-hPa geopotential heights. We’ll discuss how to
do that in the Plotting section.</p>
</div>
<div class="section" id="calculations">
<h3>Calculations<a class="headerlink" href="#calculations" title="Permalink to this headline">¶</a></h3>
<p>Meteorology and atmospheric science are fully-dependent on complex equations and formulas.
Rather than figuring out how to write them efficiently in Python yourself, MetPy provides
support for many of the common equations within the field. For the full list, please see the
<a class="reference internal" href="../api/generated/metpy.calc.html"><span class="doc">Calculations</span></a> reference guide. If you don’t see the equation
you’re looking for, consider submitting a feature request to MetPy
<a class="reference external" href="https://github.com/Unidata/MetPy/issues/new/choose">here</a>.</p>
<p>To demonstrate some of the calculations MetPy can do, let’s show a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>

<span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degC</span>
<span class="n">rel_humidity</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">percent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint_from_relative_humidity</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">rel_humidity</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">9.27008599</span><span class="p">])</span> <span class="o">&lt;</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">knots</span>
<span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">])</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degrees</span>
<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">wind_components</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">10</span> <span class="mi">0</span> <span class="mi">20</span><span class="p">]</span> <span class="n">knot</span>
<span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="mi">0</span> <span class="mi">15</span> <span class="mi">0</span><span class="p">]</span> <span class="n">knot</span>
</pre></div>
</div>
<p>As discussed above, if you don’t provide units to these functions, they will frequently
fail with the following error:</p>
<pre class="literal-block">ValueError: <em class="xref py py-obj">calculation</em> given arguments with incorrect units: <em class="xref py py-obj">variable</em> requires
&quot;[<em class="xref py py-obj">type of unit</em>]&quot; but given &quot;none&quot;. Any variable <em class="xref py py-obj">x</em> can be assigned a unit as follows:
from metpy.units import units
x = x * units.meter / units.second</pre>
<p>If you see this error in your code, just attach the appropriate units and you’ll be good to go!</p>
</div>
<div class="section" id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<p>MetPy contains two special types of meteorological plots, the Skew-T Log-P and Station plots,
that more general Python plotting packages don’t support as readily. Additionally, with the
goal to replace GEMPAK, MetPy’s declarative plotting interface is being actively developed,
which will make plotting a simple task with straight-forward syntax, similar to GEMPAK.</p>
<div class="section" id="skew-t">
<h4>Skew-T<a class="headerlink" href="#skew-t" title="Permalink to this headline">¶</a></h4>
<p>The Skew-T Log-P diagram is the canonical thermodynamic diagram within meteorology. Using
<code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code>, MetPy is able to readily create a Skew-T for you:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>
<span class="kn">from</span> <span class="nn">metpy.plots</span> <span class="kn">import</span> <span class="n">SkewT</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">SkewT</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="c1"># Create arrays of pressure, temperature, dewpoint, and wind components</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">902</span><span class="p">,</span> <span class="mi">897</span><span class="p">,</span> <span class="mi">893</span><span class="p">,</span> <span class="mi">889</span><span class="p">,</span> <span class="mi">883</span><span class="p">,</span> <span class="mi">874</span><span class="p">,</span> <span class="mi">866</span><span class="p">,</span> <span class="mi">857</span><span class="p">,</span> <span class="mi">849</span><span class="p">,</span> <span class="mi">841</span><span class="p">,</span> <span class="mi">833</span><span class="p">,</span> <span class="mi">824</span><span class="p">,</span> <span class="mi">812</span><span class="p">,</span> <span class="mi">796</span><span class="p">,</span> <span class="mi">776</span><span class="p">,</span> <span class="mi">751</span><span class="p">,</span>
     <span class="mi">727</span><span class="p">,</span> <span class="mi">704</span><span class="p">,</span> <span class="mi">680</span><span class="p">,</span> <span class="mi">656</span><span class="p">,</span> <span class="mi">629</span><span class="p">,</span> <span class="mi">597</span><span class="p">,</span> <span class="mi">565</span><span class="p">,</span> <span class="mi">533</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">468</span><span class="p">,</span> <span class="mi">435</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">366</span><span class="p">,</span> <span class="mi">331</span><span class="p">,</span> <span class="mi">295</span><span class="p">,</span> <span class="mi">258</span><span class="p">,</span>
     <span class="mi">220</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">106</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.1</span><span class="p">,</span>
     <span class="o">-</span><span class="mf">5.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.4</span><span class="p">,</span>
     <span class="o">-</span><span class="mi">28</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">43</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">54</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">57</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degC</span>
<span class="n">td</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">22</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.4</span><span class="p">,</span>
      <span class="o">-</span><span class="mf">21.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">44</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">43</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">,</span>
      <span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">63</span><span class="p">,</span> <span class="o">-</span><span class="mi">72</span><span class="p">,</span> <span class="o">-</span><span class="mi">88</span><span class="p">,</span> <span class="o">-</span><span class="mi">93</span><span class="p">,</span> <span class="o">-</span><span class="mi">92</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degC</span>
<span class="c1"># Calculate parcel profile</span>
<span class="n">prof</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">parcel_profile</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">knots</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">knots</span>

<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prof</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>  <span class="c1"># Plot parcel profile</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot_barbs</span><span class="p">(</span><span class="n">p</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="n">u</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="n">v</span><span class="p">[::</span><span class="mi">5</span><span class="p">])</span>

<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Add the relevant special lines</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot_dry_adiabats</span><span class="p">()</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot_moist_adiabats</span><span class="p">()</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot_mixing_lines</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/startingguide-1.png" src="../_images/startingguide-1.png" />
</div>
<p>For some MetPy Monday videos on Skew-Ts, please watch <a class="reference external" href="https://youtu.be/oog6_b-844Q">#16</a>, <a class="reference external" href="https://youtu.be/quFXzaNbWXM">#18</a>, and <a class="reference external" href="https://youtu.be/7QsBJTwuLvE">#19</a>. Hodographs
can also be created and plotted with a Skew-T (see MetPy Monday video <a class="reference external" href="https://youtu.be/c0Uc7imDNv0">#38</a>).
For more examples on how to do create Skew-Ts and Hodographs, please visit
check out the <a class="reference internal" href="../examples/plots/Simple_Sounding.html"><span class="doc">Simple Sounding</span></a>,
<a class="reference internal" href="../examples/Advanced_Sounding.html"><span class="doc">Advanced Sounding</span></a>, and
<a class="reference internal" href="../examples/plots/Hodograph_Inset.html"><span class="doc">Hodograph Inset</span></a>.</p>
</div>
<div class="section" id="station-plots">
<h4>Station Plots<a class="headerlink" href="#station-plots" title="Permalink to this headline">¶</a></h4>
<p>Station plots display surface or upper-air station data in a concise manner. The creation of
these plots is made straightforward with MetPy. MetPy supplies the ability to create each
station plot and place the points on the map. The creation of 2-D cartographic maps, commonly
used in meteorology for observational and model visualization, relies upon the <code class="xref py py-mod docutils literal notranslate"><span class="pre">CartoPy</span></code>
library. This package handles projections and transforms to make sure your data is plotted in
the correct location.</p>
<p>For examples on how to make a station plot, please see the
<a class="reference internal" href="../examples/plots/Station_Plot.html"><span class="doc">Station Plot</span></a> and
<a class="reference internal" href="../examples/plots/Station_Plot_with_Layout.html"><span class="doc">Station Plot Layout</span></a> examples.</p>
</div>
<div class="section" id="gridded-data">
<h4>Gridded Data<a class="headerlink" href="#gridded-data" title="Permalink to this headline">¶</a></h4>
<p>While MetPy doesn’t provide many new tools for 2-D gridded data maps, we do provide lots of
examples illustrating how to use MetPy for data analysis and CartoPy for visualization. Those
examples can be found in the <a class="reference internal" href="../examples/index.html"><span class="doc">MetPy Gallery</span></a> and at the
<a class="reference external" href="https://unidata.github.io/python-training">Unidata Python Training</a> site.</p>
<p>One unique tool in MetPy for gridded data is cross-section analysis. A detailed example of how
to create a cross section with your gridded data is available
<a class="reference internal" href="../examples/cross_section.html"><span class="doc">here</span></a>.</p>
</div>
<div class="section" id="declarative-plotting">
<h4>Declarative Plotting<a class="headerlink" href="#declarative-plotting" title="Permalink to this headline">¶</a></h4>
<p>The declarative plotting interface, which is still under active development, aims to replicate
the simple plotting declarations in GEMPAK to make map creation straightforward, especially
for those less familiar with Python, CartoPy, and matplotlib. To demonstrate the ease of
creating a plot with this interface, let’s make a color-filled plot of temperature using
NARR data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">metpy.cbook</span> <span class="kn">import</span> <span class="n">get_test_data</span>
<span class="kn">from</span> <span class="nn">metpy.plots</span> <span class="kn">import</span> <span class="n">ImagePlot</span><span class="p">,</span> <span class="n">MapPanel</span><span class="p">,</span> <span class="n">PanelContainer</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>

<span class="c1"># Use sample NARR data for plotting</span>
<span class="n">narr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">get_test_data</span><span class="p">(</span><span class="s1">&#39;narr_example.nc&#39;</span><span class="p">,</span> <span class="n">as_file_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">ImagePlot</span><span class="p">()</span>
<span class="n">img</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">narr</span>
<span class="n">img</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="s1">&#39;Geopotential_height&#39;</span>
<span class="n">img</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">850</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span>

<span class="n">panel</span> <span class="o">=</span> <span class="n">MapPanel</span><span class="p">()</span>
<span class="n">panel</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="s1">&#39;us&#39;</span>
<span class="n">panel</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;coastline&#39;</span><span class="p">,</span> <span class="s1">&#39;borders&#39;</span><span class="p">,</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;rivers&#39;</span><span class="p">,</span> <span class="s1">&#39;ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">]</span>
<span class="n">panel</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;NARR Example&#39;</span>
<span class="n">panel</span><span class="o">.</span><span class="n">plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">img</span><span class="p">]</span>

<span class="n">pc</span> <span class="o">=</span> <span class="n">PanelContainer</span><span class="p">()</span>
<span class="n">pc</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">pc</span><span class="o">.</span><span class="n">panels</span> <span class="o">=</span> <span class="p">[</span><span class="n">panel</span><span class="p">]</span>
<span class="n">pc</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/startingguide-2.png" src="../_images/startingguide-2.png" />
</div>
<p>Other plot types are available, including contouring to create overlay maps. For an example of
this, check out the <a class="reference internal" href="../examples/plots/Combined_plotting.html"><span class="doc">Combined Plotting</span></a> example.
MetPy Monday videos <a class="reference external" href="https://youtu.be/mbxE2ovXx9M">#69</a>, <a class="reference external" href="https://youtu.be/QgS27jwj8OI">#70</a>, and <a class="reference external" href="https://youtu.be/RBJ8Pm7x4ok">#71</a> also demonstrate the declarative plotting
interface.</p>
</div>
</div>
</div>
<div class="section" id="other-python-resources">
<h2>Other Python Resources<a class="headerlink" href="#other-python-resources" title="Permalink to this headline">¶</a></h2>
<p>While MetPy does a lot of things, it doesn’t do everything. Here are some other good resources
to use as you start using MetPy and Python for meteorology and atmospheric science:</p>
<p><strong>Learning Resources</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://unidata.github.io/python-training">Unidata Python Training</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/playlist?list=PLQut5OXpV-0ir4IdllSt1iEZKTwFBa7kO">MetPy Monday Playlist</a></p></li>
</ul>
<p><strong>Useful Python Packages</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://unidata.github.io/siphon/">Siphon</a>: remote access of meteorological data, including simple web services and and via
<a class="reference external" href="https://www.unidata.ucar.edu/software/tds/current/">THREDDS Data Servers</a></p></li>
<li><p><a class="reference external" href="https://unidata.github.io/netcdf4-python/">netCDF4-python</a> is the officially blessed Python API for <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a></p></li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a>: reading/writing labeled N-dimensional arrays</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org">Pandas</a>: reading/writing tabular data</p></li>
<li><p><a class="reference external" href="https://numpy.org/devdocs">NumPy</a>: numerical computations</p></li>
<li><p><a class="reference external" href="https://matplotlib.org">Matplotlib</a>: creation of publication-quality figures</p></li>
<li><p><a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">CartoPy</a>: publication-quality cartographic maps</p></li>
<li><p><a class="reference external" href="https://satpy.readthedocs.io/en/latest/">SatPy</a>: read and visualize satellite data</p></li>
<li><p><a class="reference external" href="https://arm-doe.github.io/pyart/">PyART</a>: read and visualize radar data</p></li>
</ul>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>Get stuck trying to use MetPy with your data? Unidata’s Python team is here to help! See our
<a class="reference internal" href="SUPPORT.html"><span class="doc">support page</span></a> for more information.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="installguide.html" title="previous page">Install Guide</a>
    <a class='right-next' id="next-link" href="../tutorials/index.html" title="next page">Tutorials</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-92978945-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021-2020, MetPy Developers. Development supported by National Science Foundation grants AGS-1344155, OAC-1740315, and AGS-1901712.<br/>
        Last updated on Feb 17, 2021 at 18:58:28.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>